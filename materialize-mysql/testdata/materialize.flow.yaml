import:
  - ../../materialize-boilerplate/testdata/integration/collections.materialize.flow.yaml

materializations:
  acmeCo/tests/materialize-mysql/mysql:
    endpoint:
      local:
        command: ["go", "run", "."]
        protobuf: true
        config: config.local.mysql.yaml
    bindings: &bindings
    - resource:
        table: simple_standard
      source: tests/simple
      fields:
        recommended: true
    - resource:
        table: simple_delta
        delta_updates: true
      source: tests/simple
      fields:
        recommended: true
    - resource:
        table: not_simple
      source: tests/not-simple
      fields:
        recommended: true
        # Not using the `_id` field because of MySQL's restrictions on key
        # column byte lengths.
        groupBy: [" ,;{}().- problematicKey ÔøΩ êÄÄ Øß¥ ", "binaryKey"]
    - resource:
        table: data_types
      source: tests/data-types
      fields:
        recommended: 1

  acmeCo/tests/materialize-mysql/mariadb:
    endpoint:
      local:
        command:
          - go
          - run
          - .
        protobuf: true
        config: config.local.mariadb.yaml
    bindings:
    - resource:
        table: simple_standard
      source: tests/simple
      fields:
        recommended: true
    - resource:
        table: simple_delta
        delta_updates: true
      source: tests/simple
      fields:
        recommended: true
    - resource:
        table: not_simple
      source: tests/not-simple
      fields:
        recommended: true
        # Not using the `_id` field because of MySQL's restrictions on key
        # column byte lengths.
        groupBy: [" ,;{}().- problematicKey ÔøΩ êÄÄ Øß¥ ", "binaryKey"]
    - resource:
        table: data_types
      source: tests/data-types
      fields:
        recommended: 1

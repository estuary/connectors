{
  "config_schema_json": {
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://github.com/estuary/connectors/materialize-postgres/config",
    "properties": {
      "address": {
        "type": "string",
        "title": "Address",
        "description": "Host and port of the database (in the form of host[:port]). Port 5432 is used as the default if no specific port is provided.",
        "order": 0
      },
      "user": {
        "type": "string",
        "title": "User",
        "description": "Database user to connect as.",
        "order": 1
      },
      "database": {
        "type": "string",
        "title": "Database",
        "description": "Name of the logical database to materialize to.",
        "order": 2
      },
      "schema": {
        "type": "string",
        "title": "Database Schema",
        "description": "Database schema for bound collection tables (unless overridden within the binding resource configuration) as well as associated materialization metadata tables",
        "default": "public",
        "order": 3
      },
      "hardDelete": {
        "type": "boolean",
        "title": "Hard Delete",
        "description": "If this option is enabled items deleted in the source will also be deleted from the destination. By default is disabled and _meta/op in the destination will signify whether rows have been deleted (soft-delete).",
        "default": false,
        "order": 4
      },
      "credentials": {
        "oneOf": [
          {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "https://github.com/estuary/connectors/materialize-postgres/user-password",
            "properties": {
              "auth_type": {
                "type": "string",
                "const": "UserPassword",
                "default": "UserPassword",
                "order": 0
              },
              "password": {
                "type": "string",
                "title": "Password",
                "description": "Password for the specified database user.",
                "secret": true
              }
            },
            "type": "object",
            "required": [
              "password"
            ],
            "title": "Password"
          },
          {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "https://github.com/estuary/connectors/go/auth/iam/aws-config",
            "properties": {
              "auth_type": {
                "type": "string",
                "const": "AWSIAM",
                "default": "AWSIAM",
                "order": 0
              },
              "aws_region": {
                "type": "string",
                "title": "AWS Region",
                "description": "AWS Region of your database"
              },
              "aws_role_arn": {
                "type": "string",
                "title": "AWS Role ARN",
                "description": "AWS Role which has access to the resource which will be assumed by Flow"
              }
            },
            "type": "object",
            "required": [
              "aws_region",
              "aws_role_arn"
            ],
            "title": "AWS IAM"
          },
          {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "https://github.com/estuary/connectors/go/auth/iam/gcp-config",
            "properties": {
              "auth_type": {
                "type": "string",
                "const": "GCPIAM",
                "default": "GCPIAM",
                "order": 0
              },
              "gcp_service_account_to_impersonate": {
                "type": "string",
                "title": "Service Account",
                "description": "GCP Service Account email for Cloud SQL IAM authentication"
              },
              "gcp_workload_identity_pool_audience": {
                "type": "string",
                "title": "Workload Identity Pool Audience",
                "description": "GCP Workload Identity Pool Audience in the format //iam.googleapis.com/projects/123/locations/global/workloadIdentityPools/test-pool/providers/test-provider"
              }
            },
            "type": "object",
            "required": [
              "gcp_service_account_to_impersonate",
              "gcp_workload_identity_pool_audience"
            ],
            "title": "Google Cloud IAM"
          },
          {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "$id": "https://github.com/estuary/connectors/go/auth/iam/azure-config",
            "properties": {
              "auth_type": {
                "type": "string",
                "const": "AzureIAM",
                "default": "AzureIAM",
                "order": 0
              },
              "azure_client_id": {
                "type": "string",
                "title": "Azure Client ID",
                "description": "Azure App Registration Client ID for Azure Active Directory authentication"
              },
              "azure_tenant_id": {
                "type": "string",
                "title": "Azure Tenant ID",
                "description": "Azure Tenant ID for Azure Active Directory authentication"
              }
            },
            "type": "object",
            "required": [
              "azure_client_id",
              "azure_tenant_id"
            ],
            "title": "Azure IAM"
          }
        ],
        "type": "object",
        "title": "Authentication",
        "default": {
          "auth_type": "UserPassword"
        },
        "discriminator": {
          "propertyName": "auth_type"
        },
        "order": 5,
        "x-iam-auth": true
      },
      "dbt_job_trigger": {
        "properties": {
          "job_id": {
            "type": "string",
            "title": "Job ID",
            "description": "dbt job ID"
          },
          "account_id": {
            "type": "string",
            "title": "Account ID",
            "description": "dbt account ID"
          },
          "access_url": {
            "type": "string",
            "title": "Access URL",
            "description": "dbt access URL can be found in your Account Settings. See go.estuary.dev/dbt-cloud-trigger",
            "pattern": "^https://.+$"
          },
          "api_key": {
            "type": "string",
            "title": "API Key",
            "description": "dbt API Key",
            "secret": true
          },
          "cause": {
            "type": "string",
            "title": "Cause Message",
            "description": "You can set a custom 'cause' message for the job trigger. Defaults to 'Estuary Flow'."
          },
          "mode": {
            "type": "string",
            "enum": [
              "skip",
              "replace",
              "ignore"
            ],
            "title": "Job Trigger Mode",
            "description": "Specifies how should already-running jobs be treated. Defaults to 'skip' which skips the trigger if a job is already running; 'replace' cancels the running job and runs a new one; while 'ignore' triggers a new job regardless of existing jobs.",
            "default": "skip"
          },
          "interval": {
            "type": "string",
            "title": "Minimum Run Interval",
            "description": "Minimum time between dbt job triggers. This interval is only triggered if data has been materialized by your task.",
            "default": "30m"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "job_id",
          "account_id",
          "api_key"
        ],
        "title": "dbt Cloud Job Trigger",
        "description": "Trigger a dbt Job when new data is available"
      },
      "advanced": {
        "properties": {
          "sslmode": {
            "type": "string",
            "enum": [
              "disable",
              "allow",
              "prefer",
              "require",
              "verify-ca",
              "verify-full"
            ],
            "title": "SSL Mode",
            "description": "Overrides SSL connection behavior by setting the 'sslmode' parameter."
          },
          "feature_flags": {
            "type": "string",
            "title": "Feature Flags",
            "description": "This property is intended for Estuary internal use. You should only modify this field as directed by Estuary support."
          }
        },
        "additionalProperties": false,
        "type": "object",
        "title": "Advanced Options",
        "description": "Options for advanced users. You should not typically need to modify these.",
        "advanced": true
      },
      "networkTunnel": {
        "properties": {
          "sshForwarding": {
            "properties": {
              "sshEndpoint": {
                "type": "string",
                "title": "SSH Endpoint",
                "description": "Endpoint of the remote SSH server that supports tunneling (in the form of ssh://user@hostname[:port])",
                "pattern": "^ssh://.+@.+$"
              },
              "privateKey": {
                "type": "string",
                "title": "SSH Private Key",
                "description": "Private key to connect to the remote SSH server.",
                "multiline": true,
                "secret": true
              }
            },
            "additionalProperties": false,
            "type": "object",
            "required": [
              "sshEndpoint",
              "privateKey"
            ],
            "title": "SSH Forwarding"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "title": "Network Tunnel",
        "description": "Connect to your system through an SSH server that acts as a bastion host for your network."
      }
    },
    "type": "object",
    "required": [
      "address",
      "user"
    ],
    "title": "SQL Connection"
  },
  "resource_config_schema_json": {
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://github.com/estuary/connectors/materialize-postgres/table-config",
    "properties": {
      "table": {
        "type": "string",
        "title": "Table",
        "description": "Name of the database table",
        "x-collection-name": true
      },
      "schema": {
        "type": "string",
        "title": "Alternative Schema",
        "description": "Alternative schema for this table (optional)",
        "x-schema-name": true
      },
      "additional_table_create_sql": {
        "type": "string",
        "title": "Additional Table Create SQL",
        "description": "Additional SQL statement(s) to be run in the same transaction that creates the table.",
        "multiline": true
      },
      "delta_updates": {
        "type": "boolean",
        "title": "Delta Update",
        "description": "Should updates to this table be done via delta updates. Default is false.",
        "default": false,
        "x-delta-updates": true
      }
    },
    "type": "object",
    "required": [
      "table"
    ],
    "title": "SQL Table"
  },
  "documentation_url": "https://go.estuary.dev/materialize-postgresql"
}

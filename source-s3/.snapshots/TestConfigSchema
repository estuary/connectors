{
  "$id": "https://github.com/estuary/connectors/source-s3/config",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "properties": {
    "advanced": {
      "additionalProperties": false,
      "advanced": true,
      "description": "Options for advanced users. You should not typically need to modify these.",
      "order": 6,
      "properties": {
        "ascendingKeys": {
          "default": false,
          "description": "Improve sync speeds by listing files from the end of the last sync, rather than listing the entire bucket prefix. This requires that you write objects in ascending lexicographic order, such as an RFC-3339 timestamp, so that key ordering matches modification time ordering. For more information see https://go.estuary.dev/xKswdo.",
          "title": "Ascending Keys",
          "type": "boolean"
        },
        "endpoint": {
          "description": "The AWS endpoint URI to connect to. Use if you're capturing from a S3-compatible API that isn't provided by AWS",
          "title": "AWS Endpoint",
          "type": "string"
        }
      },
      "title": "Advanced",
      "type": "object"
    },
    "bucket": {
      "description": "Name of the S3 bucket",
      "order": 1,
      "title": "Bucket",
      "type": "string"
    },
    "credentials": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "https://github.com/estuary/connectors/source-s3/credentials-config",
      "oneOf": [
        {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "$id": "https://github.com/estuary/connectors/source-s3/access-key-credentials",
          "properties": {
            "auth_type": {
              "type": "string",
              "const": "AWSAccessKey",
              "default": "AWSAccessKey",
              "order": 0
            },
            "aws_access_key_id": {
              "type": "string",
              "title": "AWS Access Key ID",
              "description": "Part of the AWS credentials that will be used to connect to S3.",
              "order": 1
            },
            "aws_secret_access_key": {
              "type": "string",
              "title": "AWS Secret Access key",
              "description": "Part of the AWS credentials that will be used to connect to S3.",
              "order": 2,
              "secret": true
            }
          },
          "type": "object",
          "required": [
            "aws_access_key_id",
            "aws_secret_access_key"
          ],
          "title": "Access Key"
        },
        {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "$id": "https://github.com/estuary/connectors/source-s3/anonymous-credentials",
          "properties": {
            "auth_type": {
              "type": "string",
              "const": "AWSAnonymous",
              "default": "AWSAnonymous",
              "order": 0
            }
          },
          "type": "object",
          "title": "Anonymous"
        },
        {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "$id": "https://github.com/estuary/connectors/go/auth/iam/aws-config",
          "properties": {
            "auth_type": {
              "type": "string",
              "const": "AWSIAM",
              "default": "AWSIAM",
              "order": 0
            },
            "aws_region": {
              "type": "string",
              "title": "AWS Region",
              "description": "AWS Region of your resource"
            },
            "aws_role_arn": {
              "type": "string",
              "title": "AWS Role ARN",
              "description": "AWS Role which has access to the resource which will be assumed by Flow"
            }
          },
          "type": "object",
          "required": [
            "aws_region",
            "aws_role_arn"
          ],
          "title": "AWS IAM"
        }
      ],
      "type": "object",
      "title": "Authentication",
      "default": {
        "auth_type": "AWSAccessKey"
      },
      "discriminator": {
        "propertyName": "auth_type"
      },
      "order": 4,
      "x-iam-auth": true
    },
    "matchKeys": {
      "description": "Filter applied to all object keys under the prefix. If provided, only objects whose absolute path matches this regex will be read. For example, you can use \".*\\.json\" to only capture json files.",
      "format": "regex",
      "order": 3,
      "title": "Match Keys",
      "type": "string"
    },
    "parser": {
      "order": 5
    },
    "prefix": {
      "description": "Prefix within the bucket to capture from.",
      "order": 2,
      "title": "Prefix",
      "type": "string"
    },
    "region": {
      "description": "The name of the AWS region where the S3 bucket is located.",
      "order": 0,
      "title": "AWS Region",
      "type": "string"
    }
  },
  "required": [
    "bucket",
    "region",
    "credentials"
  ],
  "title": "S3 Source",
  "type": "object"
}
